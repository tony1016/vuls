from scapy.all import *

def findConnectedPort(srcHost,dstHost,dstPort):
    srcPort=random.randint(1024,65535)
    SYN=IP(dst=dstHost)/TCP(sport=srcPort,dport=dstPort,flags="S")
    SYNACK=sr1(SYN)
    ACK=IP(dst=dstHost)/TCP(sport=srcPort,dport=dstPort,flags="A",seq=SYNACK.ack, ack=SYNACK.seq + 1)
    send(ACK)

    RST=IP(dst=dstHost)/TCP(sport=srcPort,dport=dstPort,flags="R",seq=[x+2 for x in range(100)])
    ans,unans=sr([p for p in RST])
    

    
